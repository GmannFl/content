id: Hurukai alert management
version: -1
name: Hurukai alert management
description: Manager security events from HarfangLab EDR
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: b137d492-29ee-488c-8e1b-4760af2f9ae3
    type: start
    task:
      id: b137d492-29ee-488c-8e1b-4760af2f9ae3
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '23'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '5':
    id: '5'
    taskid: 4c84b558-cb5f-4455-85c0-bfb7cc75b53f
    type: regular
    task:
      id: 4c84b558-cb5f-4455-85c0-bfb7cc75b53f
      version: -1
      name: 'Set incident isolated flag '
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '13'
    scriptarguments:
      isolated:
        simple: Agent successfully isolated.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '8':
    id: '8'
    taskid: 7b61a19c-ead4-4a51-8a30-afb0eb7a0163
    type: title
    task:
      id: 7b61a19c-ead4-4a51-8a30-afb0eb7a0163
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: Done
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '10':
    id: '10'
    taskid: b7b1e707-3972-4bde-802a-c853e5591b92
    type: condition
    task:
      id: b7b1e707-3972-4bde-802a-c853e5591b92
      version: -1
      name: Can the agent be isolated ?
      description: Check if the agent's policy allows isolation
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      No:
      - '11'
      Yes:
      - '18'
    separatecontext: false
    conditions:
    - label: No
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Harfanglab
                accessor: Agent
                transformers:
                - operator: getField
                  args:
                    field:
                      value:
                        simple: policy
                - operator: getField
                  args:
                    field:
                      value:
                        simple: use_isolation
            iscontext: true
          right:
            value:
              simple: 'false'
    - label: Yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Harfanglab
                accessor: Agent
                transformers:
                - operator: getField
                  args:
                    field:
                      value:
                        simple: policy
                - operator: getField
                  args:
                    field:
                      value:
                        simple: use_isolation
            iscontext: true
          right:
            value:
              simple: 'true'
    view: |-
      {
        "position": {
          "x": 730,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '11':
    id: '11'
    taskid: fddef7d9-5a3a-4f4b-8138-0774062540a5
    type: regular
    task:
      id: fddef7d9-5a3a-4f4b-8138-0774062540a5
      version: -1
      name: Manually isolate endpoint
      description: Asks an analyst to manually isolate the endpoint
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '5'
    separatecontext: false
    sla:
      minutes: 5
      hours: 0
      days: 0
      weeks: 0
    defaultassigneecomplex:
      simple: Analyst
    view: |-
      {
        "position": {
          "x": 490,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '12':
    id: '12'
    taskid: 94a91131-3bcc-400a-82aa-e77a62233ac5
    type: title
    task:
      id: 94a91131-3bcc-400a-82aa-e77a62233ac5
      version: -1
      name: Agent isolation
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '17'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '13':
    id: '13'
    taskid: 62b119d5-b535-4276-8924-9d2836956ddc
    type: title
    task:
      id: 62b119d5-b535-4276-8924-9d2836956ddc
      version: -1
      name: Forensics data collection
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '36'
      - '42'
      - '45'
      - '35'
      - '41'
      - '56'
      - '57'
      - '55'
      - '43'
      - '51'
      - '44'
      - '53'
      - '52'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1020
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '14':
    id: '14'
    taskid: b985f429-becb-4b36-83d5-de65d8fa5e6e
    type: title
    task:
      id: b985f429-becb-4b36-83d5-de65d8fa5e6e
      version: -1
      name: Agent reconnection
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '19'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '17':
    id: '17'
    taskid: 777486ef-cc13-421d-8dd8-9861dab5df8b
    type: regular
    task:
      id: 777486ef-cc13-421d-8dd8-9861dab5df8b
      version: -1
      name: Get endpoint information (OS, policy...)
      description: Get endpoint information from agent_id
      script: Hurukai|||harfanglab-get-endpoint-info
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '10'
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '18':
    id: '18'
    taskid: 1b77ea64-fcff-43e5-8d4e-b181e47d6462
    type: regular
    task:
      id: 1b77ea64-fcff-43e5-8d4e-b181e47d6462
      version: -1
      name: harfanglab-isolate-endpoint
      description: Command used to isolate an endpoint from the network while remaining connected to the EDR manager
      script: Hurukai|||harfanglab-isolate-endpoint
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '5'
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 970,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '19':
    id: '19'
    taskid: eaabe572-7b34-42cc-8583-dd4438c57cf4
    type: regular
    task:
      id: eaabe572-7b34-42cc-8583-dd4438c57cf4
      version: -1
      name: harfanglab-deisolate-endpoint
      description: Command used to deisolate an endpoint and reconnect it to the network
      script: Hurukai|||harfanglab-deisolate-endpoint
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '59'
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '23':
    id: '23'
    taskid: a76f0b12-226e-47fd-8d49-841b57f8e2a5
    type: condition
    task:
      id: a76f0b12-226e-47fd-8d49-841b57f8e2a5
      version: -1
      name: Should the alert be investigated (type, severity) ?
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '65'
      Critical severity and yara / sigma / ransomware / hlai type:
      - '60'
    separatecontext: false
    conditions:
    - label: Critical severity and yara / sigma / ransomware / hlai type
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: ransom
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: yara
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: sigma
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: hlai
      - - operator: isEqualString
          left:
            value:
              simple: incident.severityStr
            iscontext: true
          right:
            value:
              simple: Critical
    view: |-
      {
        "position": {
          "x": 265,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '35':
    id: '35'
    taskid: 47897fc3-04de-4333-803b-713fa782eaed
    type: playbook
    task:
      id: 47897fc3-04de-4333-803b-713fa782eaed
      version: -1
      name: Hurukai - Get Driver List
      playbookName: Hurukai - Get Driver List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '36':
    id: '36'
    taskid: 39f14438-d7e2-4737-810c-3f9bbf34dc0c
    type: playbook
    task:
      id: 39f14438-d7e2-4737-810c-3f9bbf34dc0c
      version: -1
      name: Hurukai - Get Process List
      playbookName: Hurukai - Get Process List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
      ostype:
        simple: ${incident.ostype}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -610,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '37':
    id: '37'
    taskid: e2837669-0318-43c7-83df-2d237017a26f
    type: title
    task:
      id: e2837669-0318-43c7-83df-2d237017a26f
      version: -1
      name: Advanced Forensics
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '54'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '38':
    id: '38'
    taskid: 65a8941b-a432-4cbb-84fc-556a3ee2d25a
    type: condition
    task:
      id: 65a8941b-a432-4cbb-84fc-556a3ee2d25a
      version: -1
      name: Should we perform advanced forensics ?
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      No:
      - '14'
      Yes:
      - '37'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Yes
      - No
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '40':
    id: '40'
    taskid: 303b3e4a-7d4c-43fa-8846-5e7e64050ed3
    type: regular
    task:
      id: 303b3e4a-7d4c-43fa-8846-5e7e64050ed3
      version: -1
      name: Investigate the incident
      description: Asks an analyst to investigation the incident
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '14'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '41':
    id: '41'
    taskid: 4bade8f8-1239-45e7-8f89-072c496cf44a
    type: playbook
    task:
      id: 4bade8f8-1239-45e7-8f89-072c496cf44a
      version: -1
      name: Hurukai - Get Pipe List
      playbookName: Hurukai - Get Pipe List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '42':
    id: '42'
    taskid: 57df125c-9df5-4a6e-8387-c4916ece115a
    type: playbook
    task:
      id: 57df125c-9df5-4a6e-8387-c4916ece115a
      version: -1
      name: Hurukai - Get Prefetch List
      playbookName: Hurukai - Get Prefetch List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '43':
    id: '43'
    taskid: 8afa818f-ed7c-4518-89fc-0d5bd5b921a2
    type: playbook
    task:
      id: 8afa818f-ed7c-4518-89fc-0d5bd5b921a2
      version: -1
      name: Hurukai - Get Runkey List
      playbookName: Hurukai - Get Runkey List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -610,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '44':
    id: '44'
    taskid: 753b88ce-3b3b-4adc-8fde-14f863a00508
    type: playbook
    task:
      id: 753b88ce-3b3b-4adc-8fde-14f863a00508
      version: -1
      name: Hurukai - Get Scheduled Task List
      playbookName: Hurukai - Get Scheduled Task List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '45':
    id: '45'
    taskid: 44cbbe83-aa0a-443b-8a57-4818a7d8da20
    type: playbook
    task:
      id: 44cbbe83-aa0a-443b-8a57-4818a7d8da20
      version: -1
      name: Hurukai - Get Service List
      playbookName: Hurukai - Get Service List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '50':
    id: '50'
    taskid: 68116565-37dc-41ef-8b61-dae76631b0e0
    type: playbook
    task:
      id: 68116565-37dc-41ef-8b61-dae76631b0e0
      version: -1
      name: Hurukai - Get Artifact RAM Dump
      playbookName: Hurukai - Get Artifact RAM Dump
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '40'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '51':
    id: '51'
    taskid: ebac4e53-6ae1-456f-815a-81496ea8c522
    type: playbook
    task:
      id: ebac4e53-6ae1-456f-815a-81496ea8c522
      version: -1
      name: Hurukai - Get Startup List
      playbookName: Hurukai - Get Startup List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '52':
    id: '52'
    taskid: 47a21355-28c5-407d-8cb9-9d84cb0da79b
    type: playbook
    task:
      id: 47a21355-28c5-407d-8cb9-9d84cb0da79b
      version: -1
      name: Hurukai - Get WMI List
      playbookName: Hurukai - Get WMI List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '53':
    id: '53'
    taskid: 44fdd86b-5dae-4a0d-8126-96f01b1063a0
    type: playbook
    task:
      id: 44fdd86b-5dae-4a0d-8126-96f01b1063a0
      version: -1
      name: Hurukai - Get Persistence List
      playbookName: Hurukai - Get Persistence List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '54':
    id: '54'
    taskid: d82ec366-4f89-4305-8e2e-cae1cd8bd692
    type: playbook
    task:
      id: d82ec366-4f89-4305-8e2e-cae1cd8bd692
      version: -1
      name: Hurukai - Get All Artifacts
      playbookName: Hurukai - Get All Artifacts
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '50'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '55':
    id: '55'
    taskid: 33e39938-313c-4fa4-8115-6a2ec9f334df
    type: playbook
    task:
      id: 33e39938-313c-4fa4-8115-6a2ec9f334df
      version: -1
      name: Hurukai - Get Network Share List
      playbookName: Hurukai - Get Network Share List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '56':
    id: '56'
    taskid: 280d4f9f-ca35-4ffb-866c-4681a66fb84f
    type: playbook
    task:
      id: 280d4f9f-ca35-4ffb-866c-4681a66fb84f
      version: -1
      name: Hurukai - Get Session List
      playbookName: Hurukai - Get Session List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '57':
    id: '57'
    taskid: 3bde48e6-5c18-41c0-8c1a-860b0a6e961b
    type: playbook
    task:
      id: 3bde48e6-5c18-41c0-8c1a-860b0a6e961b
      version: -1
      name: Hurukai - Get Network Connection List
      playbookName: Hurukai - Get Network Connection List
      type: playbook
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '38'
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '58':
    id: '58'
    taskid: 9a4757a1-815f-4919-8b38-8dd3090c4a8b
    type: title
    task:
      id: 9a4757a1-815f-4919-8b38-8dd3090c4a8b
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": 0
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '59':
    id: '59'
    taskid: 2bb0c365-3a8b-4a0e-8ee5-1daf82536043
    type: regular
    task:
      id: 2bb0c365-3a8b-4a0e-8ee5-1daf82536043
      version: -1
      name: 'Set incident isolated flag '
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '62'
    scriptarguments:
      isolated:
        simple: Agent successfully reconnected.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '60':
    id: '60'
    taskid: 42c94967-4ac2-4572-8db4-0c1c2d46eda5
    type: regular
    task:
      id: 42c94967-4ac2-4572-8db4-0c1c2d46eda5
      version: -1
      name: Set incident status to 'Investigating' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '64'
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: Investigating
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '61':
    id: '61'
    taskid: 4a5247c9-5e0f-465a-8e31-b6a0a7e982cf
    type: regular
    task:
      id: 4a5247c9-5e0f-465a-8e31-b6a0a7e982cf
      version: -1
      name: Set incident status to 'Closed' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '66'
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: Closed
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -10,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '62':
    id: '62'
    taskid: ca33c160-3399-449a-8586-88500d8cd358
    type: condition
    task:
      id: ca33c160-3399-449a-8586-88500d8cd358
      version: -1
      name: Was it a false positive ?
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      No:
      - '61'
      Yes:
      - '63'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Yes
      - No
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '63':
    id: '63'
    taskid: 6a10ef08-a434-43c2-8541-a2a9515a95c1
    type: regular
    task:
      id: 6a10ef08-a434-43c2-8541-a2a9515a95c1
      version: -1
      name: Set incident status to 'False Positive' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - '66'
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: False Positive
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 545,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '64':
    id: '64'
    taskid: fa4f10bf-844f-4cbd-8c66-e92860ad8c1a
    type: condition
    task:
      id: fa4f10bf-844f-4cbd-8c66-e92860ad8c1a
      version: -1
      name: Should I isolate the endpoint before starting investigation ?
      description: Check whether the values provided in arguments are equal. If either of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      No:
      - '13'
      Yes:
      - '12'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Yes
      - No
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '65':
    id: '65'
    taskid: ae6d052c-25ac-4b96-8122-5edac17821f2
    type: regular
    task:
      id: ae6d052c-25ac-4b96-8122-5edac17821f2
      version: -1
      name: Close XSOAR incident
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '58'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": -185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '66':
    id: '66'
    taskid: 38e85675-d08e-4971-8b18-f1e2d0e14735
    type: regular
    task:
      id: 38e85675-d08e-4971-8b18-f1e2d0e14735
      version: -1
      name: Close XSOAR incident
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '8'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "10_18_Yes": 0.54,
      "23_60_Critical severity and yara / sigma / ransomware / hlai type": 0.42,
      "38_37_Yes": 0.72
    },
    "paper": {
      "dimensions": {
        "height": 4265,
        "width": 2120,
        "x": -610,
        "y": -570
      }
    }
  }
inputs: []
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.2.0
