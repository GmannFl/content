id: Hurukai alert management
version: 21
vcShouldKeepItemLegacyProdMachine: false
name: Hurukai alert management
description: Manager security events from HarfangLab EDR
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: afd00190-e6c8-457f-81e4-d5974da1f2d8
    type: start
    task:
      id: afd00190-e6c8-457f-81e4-d5974da1f2d8
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 7ec4304a-13c6-4c6c-8af0-33c1da4beed3
    type: regular
    task:
      id: 7ec4304a-13c6-4c6c-8af0-33c1da4beed3
      version: -1
      name: 'Set incident isolated flag '
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      isolated:
        simple: Agent successfully isolated.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 9e727bba-083e-424b-8113-1d23dfecbeb1
    type: title
    task:
      id: 9e727bba-083e-424b-8113-1d23dfecbeb1
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3630
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 046b0f6a-0443-463f-8029-4158ebc8c746
    type: condition
    task:
      id: 046b0f6a-0443-463f-8029-4158ebc8c746
      version: -1
      name: Can the agent be isolated ?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "11"
      "Yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "No"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Harfanglab
                accessor: Agent
                transformers:
                - operator: getField
                  args:
                    field:
                      value:
                        simple: policy
                - operator: getField
                  args:
                    field:
                      value:
                        simple: use_isolation
            iscontext: true
          right:
            value:
              simple: "false"
    - label: "Yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Harfanglab
                accessor: Agent
                transformers:
                - operator: getField
                  args:
                    field:
                      value:
                        simple: policy
                - operator: getField
                  args:
                    field:
                      value:
                        simple: use_isolation
            iscontext: true
          right:
            value:
              simple: "true"
    view: |-
      {
        "position": {
          "x": 730,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 8ab48041-4c6a-4825-83db-5925dae67772
    type: regular
    task:
      id: 8ab48041-4c6a-4825-83db-5925dae67772
      version: -1
      name: Manually isolate endpoint
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    separatecontext: false
    sla:
      minutes: 5
      hours: 0
      days: 0
      weeks: 0
    defaultassigneecomplex:
      simple: Analyst
    view: |-
      {
        "position": {
          "x": 490,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: d790589c-ec9a-4f52-8e68-3606ae907968
    type: title
    task:
      id: d790589c-ec9a-4f52-8e68-3606ae907968
      version: -1
      name: Agent isolation
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 3cacc002-e869-4c2f-8c63-a3ce8718decc
    type: title
    task:
      id: 3cacc002-e869-4c2f-8c63-a3ce8718decc
      version: -1
      name: Forensics data collection
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1035
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: d08e3ce2-5cf5-4101-8d7b-5c2edb249d04
    type: title
    task:
      id: d08e3ce2-5cf5-4101-8d7b-5c2edb249d04
      version: -1
      name: Agent reconnection
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: 09aeefb7-ceb9-4e96-82d6-d0d27ab086cf
    type: regular
    task:
      id: 09aeefb7-ceb9-4e96-82d6-d0d27ab086cf
      version: -1
      name: Get endpoint information (OS, policy...)
      description: Get endpoint information from agent_id
      script: Hurukai|||harfanglab-get-endpoint-info
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: f3af572c-bf9a-49a4-8bcf-085282af724e
    type: regular
    task:
      id: f3af572c-bf9a-49a4-8bcf-085282af724e
      version: -1
      name: harfanglab-isolate-endpoint
      description: Command used to isolate an endpoint from the network while remaining
        connected to the EDR manager
      script: Hurukai|||harfanglab-isolate-endpoint
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 970,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 640162f9-4481-4dcd-8c79-736cb31e0e81
    type: regular
    task:
      id: 640162f9-4481-4dcd-8c79-736cb31e0e81
      version: -1
      name: harfanglab-deisolate-endpoint
      description: Command used to deisolate an endpoint and reconnect it to the network
      script: Hurukai|||harfanglab-deisolate-endpoint
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      agent_id:
        simple: ${incident.agentid}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: 7b24c160-fe00-4601-89de-ef1f8968880e
    type: condition
    task:
      id: 7b24c160-fe00-4601-89de-ef1f8968880e
      version: -1
      name: Should the alert be investigated (type, severity) ?
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "65"
      Critical severity and yara / sigma / ransomware / hlai type:
      - "60"
    separatecontext: false
    conditions:
    - label: Critical severity and yara / sigma / ransomware / hlai type
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: ransom
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: yara
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: sigma
        - operator: isEqualString
          left:
            value:
              simple: incident.alertcategory
            iscontext: true
          right:
            value:
              simple: hlai
      - - operator: isEqualString
          left:
            value:
              simple: incident.severityStr
            iscontext: true
          right:
            value:
              simple: Critical
    view: |-
      {
        "position": {
          "x": 265,
          "y": -420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: b8cf7837-ee92-4151-8b85-be6242b5f840
    type: playbook
    task:
      id: b8cf7837-ee92-4151-8b85-be6242b5f840
      version: -1
      name: Get Driver List
      playbookName: Hurukai - Get Driver List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: ca4addf0-f79d-4dbb-8c9d-d4710c6055ae
    type: playbook
    task:
      id: ca4addf0-f79d-4dbb-8c9d-d4710c6055ae
      version: -1
      name: Get Process List
      playbookName: Hurukai - Get Process List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
      ostype:
        simple: ${incident.ostype}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -610,
          "y": 1180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 45759f22-02e3-4657-8844-537d99ac4944
    type: title
    task:
      id: 45759f22-02e3-4657-8844-537d99ac4944
      version: -1
      name: Advanced Forensics
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 1925
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: d9f53d80-5df8-473d-8586-c26fd5317d89
    type: condition
    task:
      id: d9f53d80-5df8-473d-8586-c26fd5317d89
      version: -1
      name: Should we perform advanced forensics ?
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "14"
      "Yes":
      - "37"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 7fd18bba-6ca8-4676-85ee-3e1a5f328e60
    type: regular
    task:
      id: 7fd18bba-6ca8-4676-85ee-3e1a5f328e60
      version: -1
      name: Investigate the incident
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 6169b59b-4ed3-4ac3-8d68-75d660b2b255
    type: playbook
    task:
      id: 6169b59b-4ed3-4ac3-8d68-75d660b2b255
      version: -1
      name: Get Pipe List
      playbookName: Hurukai - Get Pipe List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 08419491-630a-46b0-84bc-c890bf1d2c6c
    type: playbook
    task:
      id: 08419491-630a-46b0-84bc-c890bf1d2c6c
      version: -1
      name: Get Prefect List
      playbookName: Hurukai - Get Prefetch List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 523942d3-d2cb-46a2-8330-e96ca4d33c49
    type: playbook
    task:
      id: 523942d3-d2cb-46a2-8330-e96ca4d33c49
      version: -1
      name: Get Runkey List
      playbookName: Hurukai - Get Runkey List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -610,
          "y": 1560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 50104cbe-b675-4211-836e-1a4ba9a6bcbe
    type: playbook
    task:
      id: 50104cbe-b675-4211-836e-1a4ba9a6bcbe
      version: -1
      name: Get Scheduled Task List
      playbookName: Hurukai - Get Scheduled Task List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 294a345a-ab2f-41ad-8d18-718d2f143b1d
    type: playbook
    task:
      id: 294a345a-ab2f-41ad-8d18-718d2f143b1d
      version: -1
      name: Get Service List
      playbookName: Hurukai - Get Service List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 13924171-16b3-42b1-8003-5c116aee7787
    type: playbook
    task:
      id: 13924171-16b3-42b1-8003-5c116aee7787
      version: -1
      name: Get RAM Dump
      playbookName: Hurukai - Get Artifact RAM Dump
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 6732a2f1-ea76-4426-86e3-a57ab52104db
    type: playbook
    task:
      id: 6732a2f1-ea76-4426-86e3-a57ab52104db
      version: -1
      name: Get Startup List
      playbookName: Hurukai - Get Startup List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 38260373-a2d7-4f3f-844c-ec06cef7cc1f
    type: playbook
    task:
      id: 38260373-a2d7-4f3f-844c-ec06cef7cc1f
      version: -1
      name: Get WMI List
      playbookName: Hurukai - Get WMI List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1130,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 690a137c-bda8-4a4c-8997-3a4a5a526a6c
    type: playbook
    task:
      id: 690a137c-bda8-4a4c-8997-3a4a5a526a6c
      version: -1
      name: Get Persistence List
      playbookName: Hurukai - Get Persistence List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: df8261d6-c262-45fe-89b2-ec4d46c17eb6
    type: playbook
    task:
      id: df8261d6-c262-45fe-89b2-ec4d46c17eb6
      version: -1
      name: Hurukai - Get All Artifacts
      playbookName: Hurukai - Get All Artifacts
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 645,
          "y": 2075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: eb764460-ab62-49a8-8647-8a7e08d4008e
    type: playbook
    task:
      id: eb764460-ab62-49a8-8647-8a7e08d4008e
      version: -1
      name: Get Network Share List
      playbookName: Hurukai - Get Network Share List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: ce3fb635-8141-4a36-8d19-cb68ca1a2153
    type: playbook
    task:
      id: ce3fb635-8141-4a36-8d19-cb68ca1a2153
      version: -1
      name: Get Session List
      playbookName: Hurukai - Get Session List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "57"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 4c392b90-1a37-42a0-89c0-3445abdbc548
    type: playbook
    task:
      id: 4c392b90-1a37-42a0-89c0-3445abdbc548
      version: -1
      name: Get Network Connection List
      playbookName: Hurukai - Get Network Connection List
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      agentid:
        simple: ${incident.agentid}
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: d4962aff-3e30-4034-8bec-088a18e02276
    type: title
    task:
      id: d4962aff-3e30-4034-8bec-088a18e02276
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": 0
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 48bdb984-d7ae-46ce-83d4-a90134886c29
    type: regular
    task:
      id: 48bdb984-d7ae-46ce-83d4-a90134886c29
      version: -1
      name: 'Set incident isolated flag '
      description: commands.local.cmd.set.incident
      script: Builtin|||setIncident
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "62"
    scriptarguments:
      isolated:
        simple: Agent successfully reconnected.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 7b38e0a6-ad79-448f-8826-02a61b99ec63
    type: regular
    task:
      id: 7b38e0a6-ad79-448f-8826-02a61b99ec63
      version: -1
      name: Set incident status to 'Investigating' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: Investigating
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": -185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: ccaed0b7-df24-4df7-8868-b708e92f740d
    type: regular
    task:
      id: ccaed0b7-df24-4df7-8868-b708e92f740d
      version: -1
      name: Set incident status to 'Closed' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: Closed
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -10,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 0f59e5c9-8fcc-4e90-8887-c1ee7d7e8402
    type: condition
    task:
      id: 0f59e5c9-8fcc-4e90-8887-c1ee7d7e8402
      version: -1
      name: Was it a false positive ?
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "61"
      "Yes":
      - "63"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: 4b4fdb95-7c2f-4272-8d9a-d871296c4546
    type: regular
    task:
      id: 4b4fdb95-7c2f-4272-8d9a-d871296c4546
      version: -1
      name: Set incident status to 'False Positive' in Harfanglab Manager
      description: Command used to change the status of a security event
      script: Hurukai|||harfanglab-change-security-event-status
      type: regular
      iscommand: true
      brand: Hurukai
    nexttasks:
      '#none#':
      - "66"
    scriptarguments:
      security_event_id:
        simple: ${incident.alertid}
      status:
        simple: False Positive
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 545,
          "y": 3270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 366f8d93-31f9-4549-8031-20e35370fc9a
    type: condition
    task:
      id: 366f8d93-31f9-4549-8031-20e35370fc9a
      version: -1
      name: Should I isolate the endpoint before starting investigation ?
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "No":
      - "13"
      "Yes":
      - "12"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to: null
      subject: null
      body:
        simple: Should I collect raw forensics artifacts ?
      methods: []
      format: ""
      bcc: null
      cc: null
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - "Yes"
      - "No"
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 0c23a1e5-d4b0-4b58-8466-b6424c1559cb
    type: regular
    task:
      id: 0c23a1e5-d4b0-4b58-8466-b6424c1559cb
      version: -1
      name: Close XSOAR incident
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 820,
          "y": -185
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 03424a6c-cd2d-4c85-84dd-dd51db56e510
    type: regular
    task:
      id: 03424a6c-cd2d-4c85-84dd-dd51db56e510
      version: -1
      name: Close XSOAR incident
      description: Close the current incident
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "8"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "10_18_Yes": 0.54,
      "23_60_Critical severity and yara / sigma / ransomware / hlai type": 0.42,
      "38_37_Yes": 0.72
    },
    "paper": {
      "dimensions": {
        "height": 4265,
        "width": 2120,
        "x": -610,
        "y": -570
      }
    }
  }
inputs: []
outputs: []
