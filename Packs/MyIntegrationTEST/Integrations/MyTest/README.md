TEST
This integration was integrated and tested with version xx of MyTest

## Configure MyTest on Cortex XSOAR

1. Navigate to **Settings** > **Integrations** > **Servers & Services**.
2. Search for MyTest.
3. Click **Add instance** to create and configure a new integration instance.

    | **Parameter** | **Description** | **Required** |
    | --- | --- | --- |
    | CTD Server URL (e.g. https://&lt;IP&gt;:5000) |  | True |
    | Username |  | True |
    | Password |  | True |
    | Trust any certificate (not secure) |  | False |
    | Use system proxy settings |  | False |
    | Incident type |  | False |
    | Fetch incidents |  | False |
    | The initial time to fetch from |  | False |
    | Minimal severity to fetch by |  | False |
    | Site ID to fetch by | All sites if none selected | False |
    | Fetch by alert type |  | False |
    | Incidents Fetch Interval |  | False |

4. Click **Test** to validate the URLs, token, and connection.
## Commands
You can execute these commands from the Cortex XSOAR CLI, as part of an automation, or in a playbook.
After you successfully execute a command, a DBot message appears in the War Room with the command details.
### claroty-get-assets
***
Gets all assets from CTD. You can apply one or more filters.


#### Base Command

`claroty-get-assets`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| fields | Asset fields to return. The default value is "all". Possible values are: all, id, name, insight_names, vendor, criticality, asset_type, last_seen, ipv4, mac, virtual_zone_name, class_type, site_name, project_parsed, risk_level, firmware_version, site_id. Default is all. | Optional | 
| criticality | Returns assets with this criticality. Can be "Low", "Medium", or "High". Possible values are: Low, Medium, High. | Optional | 
| insight_name | Get assets with that include the given insight name. Possible values are: . | Optional | 
| should_enrich_assets | Add aditional value for the asset CVEs. Possible values are: True, False. Default is False. | Optional | 
| asset_limit | Maximal value of assets to query at once. Default is 10. | Optional | 
| assets_last_seen | Get all assets seen last from the given date. Format - YYYY-MM-DDThh:mm:ssZ. Example - 2020-02-02T01:02:03Z. | Optional | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Claroty.Asset.AssetID | Number | The ID of the asset. | 
| Claroty.Asset.AssetType | String | The asset type. | 
| Claroty.Asset.CVE.CVSS | String | CVE Score. | 
| Claroty.Asset.CVE.Description | String | CVE Description. | 
| Claroty.Asset.CVE.ID | String | CVE ID. | 
| Claroty.Asset.CVE.Modified | Date | CVE modification date. | 
| Claroty.Asset.CVE.Published | Date | CVE publish date. | 
| CVE.CVSS | String | CVE Score. | 
| CVE.Description | String | CVE Description. | 
| CVE.ID | String | CVE ID. | 
| CVE.Modified | Date | CVE modification date. | 
| CVE.Published | Date | CVE publish date. | 
| Claroty.Asset.ClassType | String | The OT/IT class type. | 
| Claroty.Asset.Criticality | String | The criticality of the asset, according to the Purdue model. | 
| Claroty.Asset.FirmwareVersion | String | The FM version of the asset. | 
| Claroty.Asset.HighestCVEScore | Number | Highest CVE Score for the Asset. | 
| Claroty.Asset.IP | String | The IPv4 address of the asset. | 
| Claroty.Asset.InsightName | String | The asset insight names generated by CTD. | 
| Claroty.Asset.LastSeen | Date | The date the asset was last seen. | 
| Claroty.Asset.MAC | String | The MAC address of the asset. | 
| Claroty.Asset.Name | String | The asset name. | 
| Claroty.Asset.ResourceID | String | The asset RID \(AssetID-SiteID\). | 
| Claroty.Asset.RiskLevel | Number | The risk indicator. | 
| Claroty.Asset.SiteID | Number | The site ID of the asset. | 
| Claroty.Asset.SiteName | String | The site name of the asset. | 
| Claroty.Asset.Vendor | String | The vendor of the asset. | 
| Claroty.Asset.VirtualZone | String | The virtual zone of the asset. | 
| Claroty.Asset.WasParsed | String | Whether the project was parsed. | 


#### Command Example
``` ```

#### Human Readable Output



### claroty-query-alerts
***
Gets alerts from CTD.


#### Base Command

`claroty-query-alerts`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| fields | Alert fields to return. Possible values are: all, resource_id, type, severity, network_id, resolved, description, alert_indicators, actionable_assets, category. Default is all. | Optional | 
| sort_by | The field by which to sort the results. The default value is "timestamp".<br/>Default sort order is ascending. Possible values are: resource_id, type, severity, network_id, resolved, description, alert_indicators, actionable_assets, id, timestamp. Default is timestamp. | Optional | 
| type | Returns alerts that match this alert type. | Optional | 
| date_from | The start date from which to get alerts. Format - YYYY-MM-DDThh:mm:ssZ. Example - 2020-02-02T01:02:03Z. | Optional | 
| sort_order | The sorting order of the alerts - descending or ascending. Possible values are: asc, desc. Default is asc. | Optional | 
| alert_limit | The maximum number of alerts to query. | Optional | 
| minimal_severity | Set minimal severity to query by. Possible values are: Low, Medium, High, Critical. | Optional | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Claroty.Alert.AlertType | String | The alert type. | 
| Claroty.Alert.AlertTypeID | Number | The alert type int value | 
| Claroty.Alert.Description | String | The alert description. | 
| Claroty.Alert.Indicator | String | The alert indicators. | 
| Claroty.Alert.NetworkID | Number | The network ID. | 
| Claroty.Alert.RelatedAssets | String | Assets related to the alert. | 
| Claroty.Alert.RelatedAssets.AssetID | Number | The ID of the asset. | 
| Claroty.Alert.RelatedAssets.AssetType | String | The asset type. | 
| Claroty.Alert.RelatedAssets.ClassType | String | The OT/IT class type. | 
| Claroty.Alert.RelatedAssets.Criticality | String | The criticality of the asset, according to the Purdue model. | 
| Claroty.Alert.RelatedAssets.FirmwareVersion | String | The FM version of the asset. | 
| Claroty.Alert.RelatedAssets.IP | String | The IPv4 address of the asset. | 
| Claroty.Alert.RelatedAssets.InsightName | String | The asset insight names generated by CTD. | 
| Claroty.Alert.RelatedAssets.LastSeen | Date | The date the asset was last seen. | 
| Claroty.Alert.RelatedAssets.MAC | String | The MAC address of the asset. | 
| Claroty.Alert.RelatedAssets.Name | String | The asset name. | 
| Claroty.Alert.RelatedAssets.ResourceID | String | The asset RID \(AssetID-SiteID\). | 
| Claroty.Alert.RelatedAssets.RiskLevel | Number | The risk indicator. | 
| Claroty.Alert.RelatedAssets.SiteID | Number | The site ID of the asset. | 
| Claroty.Alert.RelatedAssets.SiteName | String | The site name of the asset. | 
| Claroty.Alert.RelatedAssets.Vendor | String | The vendor of the asset. | 
| Claroty.Alert.RelatedAssets.VirtualZone | String | The virtual zone of the asset. | 
| Claroty.Alert.RelatedAssets.WasParsed | String | Whether the project was parsed. | 
| Claroty.Alert.Resolved | Number | The resolve status of the alert. | 
| Claroty.Alert.ResourceID | String | The alert resource ID \(AlertID-SiteID\). | 
| Claroty.Alert.Severity | String | The alert severity. | 
| Claroty.Alert.Category | String | The alert category. | 


#### Command Example
``` ```

#### Human Readable Output



### claroty-resolve-alert
***
Resolves alerts.


#### Base Command

`claroty-resolve-alert`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| selected_alerts | The ResourceId of the Alerts to resolve (in &lt;alert_id&gt;-&lt;site_id&gt; format). | Required | 
| resolve_as | How to resolve the alert. Can be "archive" or "resolve". The default value is "resolve". Possible values are: archive, resolve. Default is resolve. | Optional | 
| resolve_comment | A comment to add when resolving an alert. Default is Resolved by Demisto. | Optional | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Claroty.Resolve_out.success | String | Success output of alert resolving. | 


#### Command Example
``` ```

#### Human Readable Output



### claroty-get-single-alert
***
Get a single alert from CTD.


#### Base Command

`claroty-get-single-alert`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| fields | Asset fields to return. The default value is "all". Possible values are: all, resource_id, type, severity, network_id, resolved, description, alert_indicators, actionable_assets. Default is all. | Optional | 
| alert_rid | Resource ID of the desired alert. Expected value - &lt;alert_id&gt;-&lt;site_id&gt;. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| Claroty.Alert.AlertType | String | The alert type. | 
| Claroty.Alert.AlertTypeID | Number | The alert type int value | 
| Claroty.Alert.Description | String | The alert description. | 
| Claroty.Alert.Indicator | String | The alert indicators. | 
| Claroty.Alert.NetworkID | Number | The network ID. | 
| Claroty.Alert.RelatedAssets | String | Assets related to the alert. | 
| Claroty.Alert.Resolved | Number | The resolve status of the alert. | 
| Claroty.Alert.ResourceID | String | The alert resource ID \(AlertID-SiteID\). | 
| Claroty.Alert.Severity | String | The alert severity. | 


#### Command Example
``` ```

#### Human Readable Output


