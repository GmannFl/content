category: Authentication
commonfields:
  id: DUO Admin
  version: -1
configuration:
- display: API Hostname
  name: hostname
  required: true
  type: 0
- display: Integration Key
  name: integration_key
  required: true
  type: 0
- display: Secret Key
  name: secret_key
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: |-
  DUO for admins.
  Must have access to the admin api in order to use this.
display: DUO Admin
name: DUO Admin
script:
  commands:
  - arguments:
    - description: The user associated with the logs.
      name: username
      required: true
    - auto: PREDEFINED
      description: Fetch logs from this time until now
      name: from
      predefined:
      - 10_seconds_ago
      - 1_minute_ago
      - 10_minutes_ago
      - 1_hour_ago
      - 10_hours_ago
      - 1_day_ago
      - 1_week_ago
      - 1_month_ago
      - 1_year_ago
      - 5_years_ago
      - 10_years_ago
      required: true
    - defaultValue: '50'
      description: The maximum number of authentication logs to return.
      name: limit
    description: Returns authentication logs associated with a user. Limited to 30
      at a time
    name: duoadmin-get-authentication-logs-by-user
    outputs:
    - contextPath: DuoAdmin.UserDetails.auth_logs.result
      description: Result of the authentication attempt
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.event_type
      description: Type of activity logged
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.reason
      description: Reason for the authentication attempt result
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.access_device.ip
      description: The GeoIP location of the access device. IP field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.access_device.hostname
      description: The GeoIP location of the access device. Hostname field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.access_device.location.city
      description: The GeoIP location of the access device. City field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.access_device.location.state
      description: The GeoIP location of the access device. State field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.access_device.location.country
      description: The GeoIP location of the access device. Country field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.auth_device.ip
      description: The GeoIP location of the authentication device. IP field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.auth_device.hostname
      description: The GeoIP location of the authentication device. Hostname field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.auth_device.location.city
      description: The GeoIP location of the authentication device. City field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.auth_device.location.state
      description: The GeoIP location of the authentication device. State field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.auth_device.location.country
      description: The GeoIP location of the authentication device. Country field
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.timestamp
      description: Timestamp of the event
      type: date
    - contextPath: DuoAdmin.UserDetails.auth_logs.application.name
      description: Name of the application accessed
      type: string
    - contextPath: DuoAdmin.UserDetails.auth_logs.factor
      description: The authentication factor
      type: string
  - arguments:
    - description: user to dissociate a device from
      name: username
      type: string
      required: true
    - description: the device id to dissociate
      name: device_id
      type: string
      required: true
    description: Dissociates a device from a user
    name: duoadmin-dissociate-device-from-user
  - arguments:
    - description: the id of the token to delete
      name: token_id
      type: string
      required: true
    description: Delete a u2f token
    name: duoadmin-delete-u2f-token
  - arguments: []
    description: Return usernames and their user id
    name: duoadmin-get-users
    outputs:
    - contextPath: DuoAdmin.UserDetails.username
      description: Username
      type: string
    - contextPath: DuoAdmin.UserDetails.user_id
      description: 'User Id '
      type: string
    - contextPath: DuoAdmin.UserDetails.status
      description: Status
      type: string
    - contextPath: DuoAdmin.UserDetails.is_enrolled
      description: is_enrolled
      type: boolean
    - contextPath: DuoAdmin.UserDetails.last_login
      description: Last_login
      type: date
    - contextPath: DuoAdmin.UserDetails.realname
      description: Real Name
      type: string
    - contextPath: DuoAdmin.UserDetails.email
      description: Email
      type: string
    - contextPath: DuoAdmin.UserDetails.phones
      description: Phone numbers
      type: string
  - arguments:
    - description: Username
      name: username
      type: string
      required: true
    description: Return devices associated with a user
    name: duoadmin-get-devices-by-user
    outputs:
    - contextPath: DuoAdmin.UserDetails.phones.phone_id
      description: Device Id
      type: string
    - contextPath: DuoAdmin.UserDetails.phones.number
      description: Device number
      type: string
    - contextPath: DuoAdmin.UserDetails.phones.platform
      description: Device platform
      type: string
    - contextPath: DuoAdmin.UserDetails.phones.last_seen
      description: Last time the device was used
      type: date
  - arguments:
    - description: username
      name: username
      type: string
      required: true
    description: Returns a list of U2F tokens associated with the given username
    name: duoadmin-get-u2f-tokens-by-user
    outputs:
    - contextPath: DuoAdmin.UserDetails.u2ftokens
      description: The list of tokens
      type: string
  - arguments: []
    description: Returns all existing devices
    name: duoadmin-get-devices
    outputs:
    - contextPath: DuoAdmin.Phones.phone_id
      description: Device Id
      type: string
    - contextPath: DuoAdmin.Phones.number
      description: Device number
      type: string
    - contextPath: DuoAdmin.Phones.platform
      description: Device platform
      type: string
    - contextPath: DuoAdmin.Phones.last_seen
      description: Last time the device was used
      type: string
    - contextPath: DuoAdmin.Phones.users
      description: Users associated with this device
      type: string
  - arguments:
    - description: Username
      name: username
      type: string
      required: true
    - description: Device Id
      name: device_id
      type: string
      required: true
    description: Associates a device to a user
    name: duoadmin-associate-device-to-user
  - arguments: []
    description: Returns administrator accounts
    name: duoadmin-get-admins
    outputs:
    - contextPath: DuoAdmin.UserDetails.admin_id
      description: Admin_id
      type: string
    - contextPath: DuoAdmin.UserDetails.admin_units
      description: Admin Units
      type: string
    - contextPath: DuoAdmin.UserDetails.created
      description: Created
      type: date
    - contextPath: DuoAdmin.UserDetails.email
      description: Email
      type: string
    - contextPath: DuoAdmin.UserDetails.last_login
      description: Last Login
      type: date
    - contextPath: DuoAdmin.UserDetails.name
      description: Name
      type: string
    - contextPath: DuoAdmin.UserDetails.phone
      description: Phone
      type: string
    - contextPath: DuoAdmin.UserDetails.role
      description: Admin Role
      type: string
    - contextPath: DuoAdmin.UserDetails.status
      description: Admin Status
      type: string
  - arguments: []
    description: Retrieves the information from the bypass code table
    name: duoadmin-get-bypass-codes
    outputs:
    - contextPath: DuoAdmin.UserDetails.bypass_code_id
      description: Bypass Code Id
      type: string
    - contextPath: DuoAdmin.UserDetails.admin_email
      description: Admin Email
      type: string
    - contextPath: DuoAdmin.UserDetails.created
      description: Bypass Created
      type: date
    - contextPath: DuoAdmin.UserDetails.expiration
      description: Bypass Expiration
      type: date
    - contextPath: DuoAdmin.UserDetails.reuse_count
      description: Bypass Reuse Count
      type: number
    - contextPath: DuoAdmin.UserDetails.user.username
      description: Username
      type: string
    - contextPath: DuoAdmin.UserDetails.user.created
      description: Created
      type: date
    - contextPath: DuoAdmin.UserDetails.user.email
      description: Email
      type: string
    - contextPath: DuoAdmin.UserDetails.user.last_login
      description: Last Login
      type: date
    - contextPath: DuoAdmin.UserDetails.user.status
      description: Status
      type: string
    - contextPath: DuoAdmin.UserDetails.user.user_id
      description: User Id
      type: string
  - arguments:
    - description: The admin_id of the admin user
      name: user_id
      type: string
      required: true
    - defaultValue: None
      description: The name of the admin user
      name: name
      type: string
    - defaultValue: None
      description: The phone number of the admin user
      name: phone
      type: string
    - defaultValue: None
      description: the password of the admin user
      name: password
      type: string
    - defaultValue: 'FALSE'
      description: a flag to determine if the password should change
      type: boolean
      name: password_change_required
      type: boolean
      predefined:
      - FALSE
      - TRUE
    - description: The status of the admin user - Only Active or Disabled - Disabled
        will not work with admin role = Owner
      name: status
      type: string
      predefined:
      - Active
      - Disabled
    description: Modify the administrator user
    name: duoadmin-modify-admin
  - arguments:
    - description: The user_id of the user
      name: user_id
      type: string
      required: true
    - description: The username of the user
      name: username
      type: string
    - description: The real name of the user
      name: realname
      type: string
    - description: The status of the user
      name: status
      type: string
    - description: Notes for the user
      name: notes
      type: string
    - description: The email of the user
      name: email
      type: string
    - description: The firstname of the user
      name: firstname
      type: string
    - description: The lastname of the user
      name: lastname
      tyoe: string
    - description: The first alias of the user
      name: alias1
      type: string
    - description: The second alias of the user
      name: alias2
      type: string
    - description: The third alias of the user
      name: alias3
      type: string
    - description: The fourth alias of the user
      name: alias4
      type: string
    - description: The list of alias of the user
      name: aliases
      type: string
    description: Modify the user account
    name: duoadmin-modify-user
  dockerimage: demisto/duoadmin:1.0.0.24033
  runonce: false
  script: ''
  subtype: python2
  type: python
fromversion: 5.0.0
tests:
- DuoAdmin API test playbook
