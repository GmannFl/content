category: Utilities
commonfields:
  id: FortiAuthenticator
  version: -1
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: Username
  displaypassword: Access Key
  name: credentials
  required: true
  type: 9
- display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    fromServerVersion: ""
    itemVersion: ""
    packID: 78f94192-42ed-4a31-8a51-d2c3cc8825b9
    propagationLabels:
    - all
    toServerVersion: ""
description: Manage user configuration on FortiAutenticator.
detaileddescription: "Steps to get the \"Access Key\" for the API authentication:
  \n\nOn the FortiAuthenticator WebUI, create a new user for API or edit an existing
  one. \nUnder the Authentication > User Management, edit the user. \n- Under User
  Role, select Administrator.\n- Enable Web service access.\n- Under User Information,
  please ensure there's  a valid email address.\n- Click OK to save the details.\n-
  The Web Service Access Secret Key used to authenticate to the API is emailed to
  the user.\n\nNote- Ensure email routing is working (i.e. the FortiAuthenticator
  is able to send mail) beforehand as the API Key will be delivered by email.\n"

display: FortiAuthenticator
name: FortiAuthenticator
script:
  commands:
  - arguments:
    - name: email
    - description: The user's email that defined in the User Information on FortiAuthenticator.
    - auto: PREDEFINED
      defaultValue: localusers
      description: 'The user type:  localusers (Local Users), ldapuser (Remote Users)'
      name: user_type
      predefined:
      - localusers
      - ldapusers
      required: true
    name: FortiAuthenticator-get-user
  - arguments:
    - name: email
      description: The user's email that defined in the User Information on FortiAuthenticator.
      required: true
    - auto: PREDEFINED
      defaultValue: "true"
      description: 'Define user''s active status:  false = Disabled, true = enabled'
      name: active
      predefined:
      - "true"
      - "false"
      required: true
    - auto: PREDEFINED
      defaultValue: localusers
      description: 'The user type:  localusers (Local Users), ldapuser (Remote Users)'
      name: user_type
      predefined:
      - localusers
      - ldapusers
      required: true
    name: FortiAuthenticator-update-user
  dockerimage: demisto/python3:3.9.5.20958
  runonce: false
  script: ''
  subtype: python3
  type: python
sourcemoduleid: FortiAuthenticator
