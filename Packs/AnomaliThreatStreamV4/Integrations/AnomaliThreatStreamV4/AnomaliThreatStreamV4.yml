category: Data Enrichment & Threat Intelligence
commonfields:
  id: Anomali ThreatStream v4
  version: -1
configuration:
- defaultvalue: https://api.threatstream.com
  display: Server URL (e.g., https://www.test.com)
  name: url
  required: true
  type: 0
- display: Username
  displaypassword: API Key
  name: credentials
  required: true
  type: 9
- display: URL threshold
  name: url_threshold
  required: false
  type: 0
- display: IP threshold
  name: ip_threshold
  required: false
  type: 0
- display: Domain threshold
  name: domain_threshold
  required: false
  type: 0
- display: File threshold
  name: file_threshold
  required: false
  type: 0
- additionalinfo: Email indicators with confidence value above this threshold are
    considered malicious.
  display: Email threshold
  name: email_threshold
  required: false
  type: 0
- additionalinfo: Whether to include inactive indicators in reputation commands.
  defaultvalue: "false"
  display: Include inactive results
  name: include_inactive
  required: false
  type: 8
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: B - Usually reliable
  display: Source Reliability
  name: integrationReliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: true
  type: 15
- defaultvalue: "false"
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- additionalinfo: Create relationships between indicators as part of enrichment.
  defaultvalue: "true"
  display: Create relationships
  name: create_relationships
  required: false
  type: 8
- defaultvalue: "false"
  display: Fetch Trusted Circle Requests
  name: fetch_trusted_circle_requests
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: "1"
  display: Incidents Fetch Interval
  name: incidentFetchInterval
  required: false
  type: 19
- display: Incident type
  name: incidentType
  required: false
  type: 13
- additionalinfo: 'Retrieve rule matches from here: https://ui.threatstream.com/rules'
  display: Rule ID (to fetch)
  name: rule_id
  required: false
  type: 0
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ec8d63fc-f25f-4534-82c2-498e6571d750
    propagationLabels:
    - all
    toServerVersion: ""
description: Use Anomali ThreatStream to query and submit threats.
display: Anomali ThreatStream v4
name: Anomali ThreatStream v4
script:
  commands:
  - arguments:
    - default: true
      description: The IP to check.
      isArray: true
      name: ip
      required: true
    - description: If confidence is greater than the threshold the IP address is considered
        malicious, otherwise it is considered good. This argument overrides the default
        IP threshold defined as a parameter.
      name: threshold
    - auto: PREDEFINED
      description: Whether to include results with an inactive status.
      name: include_inactive
      predefined:
      - "True"
      - "False"
    description: Checks the reputation of the given IP address.
    name: ip
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: IP.ASN
      description: The Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: IP.Address
      description: The IP address of the indicator.
      type: String
    - contextPath: IP.Geo.Country
      description: The country associated with the indicator.
      type: String
    - contextPath: IP.Geo.Location
      description: The longitude and latitude of the IP address.
      type: String
    - contextPath: ThreatStream.IP.ASN
      description: The Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.IP.Address
      description: The IP address of the indicator.
      type: String
    - contextPath: ThreatStream.IP.Country
      description: The country associated with the indicator.
      type: String
    - contextPath: ThreatStream.IP.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.IP.Modified
      description: 'The time the indicator was last updated. The date format is: YYYYMMDDThhmmss,
        where "T" denotes the start of the value for time in UTC time.'
      type: String
    - contextPath: ThreatStream.IP.Severity
      description: The indicator severity ("very-high", "high", "medium", or "low").
      type: String
    - contextPath: ThreatStream.IP.Confidence
      description: The observable certainty level of a reported indicator type. Confidence
        score can range from 0-100, in increasing order of confidence.
      type: String
    - contextPath: ThreatStream.IP.Status
      description: The status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.IP.Organization
      description: The name of the business that owns the IP address associated with
        the indicator.
      type: String
    - contextPath: ThreatStream.IP.Source
      description: The indicator source.
      type: String
    - contextPath: IP.Malicious.Vendor
      description: The vendor that reported the indicator as malicious.
      type: String
    - contextPath: ThreatStream.IP.Tags
      description: Tags assigned to the IP.
      type: Unknown
    - contextPath: IP.Tags
      description: List of IP Tags.
      type: Unknown
    - contextPath: IP.ThreatTypes
      description: Threat types associated with the IP.
      type: Unknown
  - arguments:
    - default: true
      description: The domain name to check.
      isArray: true
      name: domain
      required: true
    - description: If confidence is greater than the threshold the Domain is considered
        malicious, otherwise it is considered good. This argument overrides the default
        Domain threshold defined as a parameter.
      name: threshold
    - auto: PREDEFINED
      description: Whether to include results with an inactive status.
      name: include_inactive
      predefined:
      - "True"
      - "False"
    description: Checks the reputation of the given domain name.
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: The domain name.
      type: String
    - contextPath: Domain.DNS
      description: The IP addresses resolved by DNS.
      type: String
    - contextPath: Domain.WHOIS.CreationDate
      description: |-
        The date the domain was created. The date format is: YYYYMMDDThhmmss, where T denotes the start of the value
        for time in UTC time.
      type: Date
    - contextPath: Domain.WHOIS.UpdatedDate
      description: |-
        The date the domain was last updated. The date format is: YYYYMMDDThhmmss, where T denotes the start of the value
        for time in UTC time.
      type: Date
    - contextPath: Domain.WHOIS.Registrant.Name
      description: The registant name.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Email
      description: The registrant email address.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Phone
      description: The registrant phone number.
      type: String
    - contextPath: ThreatStream.Domain.ASN
      description: The Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Address
      description: The indicator domain name.
      type: String
    - contextPath: ThreatStream.Domain.Country
      description: The country associated with the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.Domain.Modified
      description: |-
        The date and time the indicator was last updated. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time in UTC time.
      type: String
    - contextPath: ThreatStream.Domain.Severity
      description: The indicator severity ("very-high", "high", "medium", "low").
      type: String
    - contextPath: ThreatStream.Domain.Confidence
      description: The observable certainty level of a reported indicator type. Confidence
        score ranges from 0-100, in increasing order of confidence.
      type: String
    - contextPath: ThreatStream.Domain.Status
      description: The status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Organization
      description: The name of the business that owns the IP address associated with
        the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Source
      description: The indicator source.
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: The vendor that reported the indicator as malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: ThreatStream.Domain.Tags
      description: Tags assigned to the domain.
      type: Unknown
    - contextPath: Domain.Tags
      description: List of domain tags.
      type: Unknown
    - contextPath: Domain.ThreatTypes
      description: Threat types associated with the domain.
      type: Unknown
  - arguments:
    - default: true
      description: The hash of file to check.
      isArray: true
      name: file
      required: true
    - description: If the confidence is greater than the threshold the hash of the
        file is considered malicious, otherwise it is considered good. This argument
        overrides the default file threshold defined as a parameter.
      name: threshold
    - auto: PREDEFINED
      description: Whether to include results with an inactive status.
      name: include_inactive
      predefined:
      - "True"
      - "False"
    description: Checks the reputation of the given hash of the file.
    name: file
    outputs:
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: String
    - contextPath: File.Malicious.Vendor
      description: The vendor that reported the indicator as malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: ThreatStream.File.Severity
      description: The indicator severity ("very-high", "high", "medium", "low").
      type: String
    - contextPath: ThreatStream.File.Confidence
      description: The observable certainty level of a reported indicator type. Confidence
        score ranges from 0-100, in increasing order of confidence.
      type: String
    - contextPath: ThreatStream.File.Status
      description: The status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.File.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.File.MD5
      description: The MD5 hash of the indicator.
      type: String
    - contextPath: ThreatStream.File.SHA1
      description: The SHA1 hash of the indicator.
      type: String
    - contextPath: ThreatStream.File.SHA256
      description: The SHA256 hash of the indicator.
      type: String
    - contextPath: ThreatStream.File.SHA512
      description: The SHA512 hash of the indicator.
      type: String
    - contextPath: ThreatStream.File.Modified
      description: |-
        The date and time the indicator was last updated. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time in UTC time.
      type: String
    - contextPath: ThreatStream.File.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.File.Tags
      description: Tags assigned to the file.
      type: Unknown
    - contextPath: File.Tags
      description: List of file tags.
      type: Unknown
    - contextPath: File.ThreatTypes
      description: Threat types associated with the file.
      type: Unknown
  - arguments:
    - description: The email address to check.
      name: email
      required: true
    - description: If the confidence is greater than the threshold the email address
        is considered malicious, otherwise it is considered good. This argument overrides
        the default email threshold defined as a parameter.
      name: threshold
    - auto: PREDEFINED
      description: Whether to include results with an inactive status.
      name: include_inactive
      predefined:
      - "True"
      - "False"
    description: Checks the reputation of the given email address.
    name: threatstream-email-reputation
    outputs:
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: ThreatStream.EmailReputation.Severity
      description: The indicator severity ("very-high", "high", "medium", "low").
      type: String
    - contextPath: ThreatStream.EmailReputation.Confidence
      description: The observable certainty level of a reported indicator type. Confidence
        score ranges from 0-100, in increasing order of confidence.
      type: String
    - contextPath: ThreatStream.EmailReputation.Status
      description: The status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.EmailReputation.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.EmailReputation.Email
      description: The indicator email address.
      type: String
    - contextPath: ThreatStream.EmailReputation.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.EmailReputation.Modified
      description: |-
        The date and time the indicator was last updated. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time in UTC time.
      type: String
    - contextPath: ThreatStream.EmailReputation.Tags
      description: Tags assigned to the email.
      type: Unknown
  - arguments:
    - auto: PREDEFINED
      defaultValue: ip
      description: The type of passive DNS search ("ip", "domain").
      name: type
      predefined:
      - ip
      - domain
      required: true
    - description: Possible values are "IP" or "Domain".
      name: value
      required: true
    - defaultValue: "50"
      description: The maximum number of results to return.
      name: limit
    description: Returns enrichment data for Domain or IP for available observables.
    name: threatstream-get-passive-dns
    outputs:
    - contextPath: ThreatStream.PassiveDNS.Domain
      description: The domain value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Ip
      description: The IP value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Rrtype
      description: The Rrtype value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Source
      description: The source value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.FirstSeen
      description: |-
        The first seen date. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.PassiveDNS.LastSeen
      description: |-
        The last seen date. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time in UTC time.
      type: String
  - arguments:
    - defaultValue: "50"
      description: The observable certainty level of a reported indicator type.
      name: confidence
    - auto: PREDEFINED
      defaultValue: private
      description: Whether the indicator data is public or private to the organization.
      name: classification
      predefined:
      - private
      - public
    - auto: PREDEFINED
      defaultValue: exploit
      description: Type of threat associated with the imported observables. Can be
        "adware", "anomalous", "anonymization", "apt", "bot", "brute", "c2", "compromised",
        "crypto", "data_leakage", "ddos", "dyn_dns", "exfil", "exploit", "hack_tool",
        "i2p", "informational", "malware", "p2p", "parked", "phish", "scan", "sinkhole",
        "spam", "suppress", "suspicious", "tor", or "vps".
      name: threat_type
      predefined:
      - adware
      - anomalous
      - anonymization
      - apt
      - bot
      - brute
      - c2
      - compromised
      - crypto
      - data_leakage
      - ddos
      - dyn_dns
      - exfil
      - exploit
      - hack_tool
      - i2p
      - informational
      - malware
      - p2p
      - parked
      - phish
      - scan
      - sinkhole
      - spam
      - suppress
      - suspicious
      - tor
      - vps
    - auto: PREDEFINED
      defaultValue: low
      description: The potential impact of the indicator type with which the observable
        is believed to be associated. Can be "low", "medium", "high", or "very-high".
      name: severity
      predefined:
      - low
      - medium
      - high
      - very-high
    - auto: PREDEFINED
      description: The import type of the indicator. Can be "datatext", "file-id",
        or "url".
      name: import_type
      predefined:
      - datatext
      - file-id
      - url
      required: true
    - description: 'The imported data source. Can be one of the following: url or
        file-id datatext of the file uploaded to the War Room. Supported file types
        for file-id are: CSV, HTML, IOC, JSON, PDF, TXT.'
      name: import_value
      required: true
    - description: Indicator type to assign if a specific type is not associated with
        an observable. This is a global setting that applies to any imported IP-type
        observable when an explicit itype is not specified for it.
      name: ip_mapping
    - description: Indicator type to assign if a specific type is not associated with
        an observable. This is a global setting that applies to any imported domain-type
        observable when an explicit itype is not specified for it.
      name: domain_mapping
    - description: Indicator type to assign if a specific type is not associated with
        an observable. This is a global setting that applies to any imported URL-type
        observable when an explicit itype is not specified for it.
      name: url_mapping
    - description: Indicator type to assign if a specific type is not associated with
        an observable. This is a global setting that applies to any imported email-type
        observable when an explicit itype is not specified for it.
      name: email_mapping
    - description: Indicator type to assign if a specific type is not associated with
        an observable. This is a global setting that applies to any imported MD5-type
        observable when an explicit itype is not specified for it.
      name: md5_mapping
    - description: tags
      name: tags
    - description: Trusted Circle ID
      name: trustedcircles
    - auto: PREDEFINED
      defaultValue: red
      description: sharing parameters of tags
      name: tag_type
      predefined:
      - white
      - red
    - auto: PREDEFINED
      defaultValue: red
      description: Traffic Light Protocol
      name: tlp
      predefined:
      - red
      - white
      - green
      - amber
    - description: 'threat model for association - format example:  {"tipreport":[{"id":3734648,"sro":{}}]}'
      name: association_info
    - description: 'Time indicator was created. Format: YYYY-MM-DDTHH:MM:SSZ'
      name: source_created
    - description: 'Time indicator was modified. Format: YYYY-MM-DDTHH:MM:SSZ'
      name: source_modified
    - description: The source of the indicator
      name: intelligence_source
    - description: 'Date/time for indicator to expire. Format: YYYY-MM-DDTHH:MM:SSZ'
      name: expiration_ts
    description: 'Imports indicators (observables) into ThreatStream. The imported
      data must be approved using the ThreatStream UI. The data can be imported using
      one of three methods: plain-text, file, or URL.'
    name: threatstream-import-indicator-with-approval
  - arguments:
    - auto: PREDEFINED
      description: The threat model of the returned list. Can be "actor", "campaign",
        "incident", "signature", "ttp", "vulnerability", or "tipreport".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    - defaultValue: "50"
      description: Limits the model size list. Specifying limit=0 returns up to a
        maximum of 1000 models. For limit=0, the output is not set in the context.
      name: limit
    description: Returns a list of threat models.
    name: threatstream-get-model-list
    outputs:
    - contextPath: ThreatStream.List.Type
      description: The threat model type.
      type: String
    - contextPath: ThreatStream.List.Name
      description: The threat model name.
      type: String
    - contextPath: ThreatStream.List.ID
      description: The threat model ID.
      type: String
    - contextPath: ThreatStream.List.CreatedTime
      description: 'The date and time of threat model creation. The date format is:
        YYYYMMDDThhmmss, where "T" denotes the start of the value for time in UTC
        time.'
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The threat model. Can be "actor", "campaign", "incident", "signature",
        "ttp", "vulnerability", or "tipreport".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    - description: The threat model ID.
      name: id
      required: true
    description: Returns an HTML file with a description of the threat model.
    name: threatstream-get-model-description
    outputs:
    - contextPath: File.Name
      description: The file name of the model description.
      type: String
    - contextPath: File.EntryID
      description: The entry ID of the model description.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The threat model. Can be "actor", "campaign", "incident", "signature",
        "ttp", "vulnerability", or "tipreport".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    - description: The model ID.
      name: id
      required: true
    - defaultValue: "20"
      description: The maximum number of results to return.
      name: limit
    description: Returns a list of indicators associated with the specified model
      and ID of the model.
    name: threatstream-get-indicators-by-model
    outputs:
    - contextPath: ThreatStream.Model.ModelType
      description: The threat model type.
      type: String
    - contextPath: ThreatStream.Model.ModelID
      description: The threat model ID.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Value
      description: The value of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ID
      description: The ID of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.IType
      description: The iType of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Severity
      description: The indicator severity associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Confidence
      description: The confidence of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Country
      description: The country of the indicator associated with the specified model
      type: String
    - contextPath: ThreatStream.Model.Indicators.Organization
      description: The organization of the indicator associated with the specified
        model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ASN
      description: The ASN of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Status
      description: The status of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Tags
      description: The tags of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Modified
      description: The date and time the indicator was last modified.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Type
      description: The indicator type.
      type: String
  - arguments:
    - auto: PREDEFINED
      defaultValue: private
      description: Classification of the Sandbox submission. Can be "private" or "public".
      name: submission_classification
      predefined:
      - private
      - public
    - auto: PREDEFINED
      defaultValue: WINDOWS10x64
      description: The platform on which the submitted URL or file is run. To obtain
        a list supported platforms run the threatstream-supported-platforms command.
        Can be "WINDOWS7", or "WINDOWSXP".
      name: report_platform
      predefined:
      - WINDOWS7
      - WINDOWS10x64
      - WINDOWS7OFFICE2010
      - MACOSXVM
      - LINUX
      - ANDROID9.0
    - auto: PREDEFINED
      defaultValue: file
      description: The detonation type. Can be "file" or "url".
      name: submission_type
      predefined:
      - file
      - url
      required: true
    - description: The submission value. Possible values are a valid URL or a file
        ID that was uploaded to the War Room to detonate.
      name: submission_value
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether the premium sandbox should be used for detonation.
      name: premium_sandbox
      predefined:
      - "false"
      - "true"
    - description: A comma-separated list of additional details for the indicator.
        This information is displayed in the Tag column of the ThreatStream UI.
      name: detail
    description: Submits a file or URL to the ThreatStream-hosted sandbox for detonation.
    name: threatstream-submit-to-sandbox
    outputs:
    - contextPath: ThreatStream.Analysis.ReportID
      description: The report ID submitted to the sandbox.
      type: String
    - contextPath: ThreatStream.Analysis.Status
      description: The analysis status.
      type: String
    - contextPath: ThreatStream.Analysis.Platform
      description: The platform of the submission submitted to the sandbox.
      type: String
  - arguments:
    - description: The report ID to check the status.
      name: report_id
      required: true
    description: Returns the current status of the report submitted to the sandbox.
      The report ID is returned from the threatstream-submit-to-sandbox command.
    name: threatstream-get-analysis-status
    outputs:
    - contextPath: ThreatStream.Analysis.ReportID
      description: The report ID of the file or URL that was detonated in the sandbox.
      type: String
    - contextPath: ThreatStream.Analysis.Status
      description: The report status of the file or URL that was detonated in the
        sandbox.
      type: String
    - contextPath: ThreatStream.Analysis.Platform
      description: The platform used for detonation.
      type: String
    - contextPath: ThreatStream.Analysis.Verdict
      description: The report verdict of the file or URL detonated in the sandbox.
        The verdict remains "benign" until detonation is complete.
      type: String
  - arguments:
    - description: The report ID to return.
      name: report_id
      required: true
    description: Returns the report of a file or URL submitted to the sandbox.
    name: threatstream-analysis-report
    outputs:
    - contextPath: ThreatStream.Analysis.ReportID
      description: The ID of the report submitted to the sandbox.
      type: String
    - contextPath: ThreatStream.Analysis.Category
      description: The report category.
      type: String
    - contextPath: ThreatStream.Analysis.Started
      description: The detonation start time.
      type: String
    - contextPath: ThreatStream.Analysis.Completed
      description: The detonation completion time.
      type: String
    - contextPath: ThreatStream.Analysis.Duration
      description: The duration of the detonation (in seconds).
      type: Number
    - contextPath: ThreatStream.Analysis.VmName
      description: The VM name.
      type: String
    - contextPath: ThreatStream.Analysis.VmID
      description: The VM ID.
      type: String
    - contextPath: ThreatStream.Analysis.Network.UdpSource
      description: The UDP source.
      type: String
    - contextPath: ThreatStream.Analysis.Network.UdpDestination
      description: The UDP destination.
      type: String
    - contextPath: ThreatStream.Analysis.Network.UdpPort
      description: The UDP port.
      type: String
    - contextPath: ThreatStream.Analysis.Network.IcmpSource
      description: The ICMP source.
      type: String
    - contextPath: ThreatStream.Analysis.Network.IcmpDestination
      description: The ICMP destination.
      type: String
    - contextPath: ThreatStream.Analysis.Network.IcmpPort
      description: The ICMP port.
      type: String
    - contextPath: ThreatStream.Analysis.Network.TcpSource
      description: The TCP source.
      type: String
    - contextPath: ThreatStream.Analysis.Network.TcpDestination
      description: The TCP destination.
      type: String
    - contextPath: ThreatStream.Analysis.Network.TcpPort
      description: The TCP port.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpSource
      description: The source of the HTTP address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpDestinaton
      description: The destination of the HTTP address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpPort
      description: The port of the HTTP address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpsSource
      description: The source of the HTTPS address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpsDestinaton
      description: The destination of the HTTPS address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.HttpsPort
      description: The port of the HTTPS address.
      type: String
    - contextPath: ThreatStream.Analysis.Network.Hosts
      description: The network analysis hosts.
      type: String
    - contextPath: ThreatStream.Analysis.Verdict
      description: The verdict of the sandbox detonation.
      type: String
  - arguments:
    - description: The Anomali Observable Search Filter Language query to filter indicator
        results. If a query is passed as an argument, it overrides all other arguments.
      name: query
    - description: The Autonomous System (AS) number associated with the indicator.
      name: asn
    - description: |-
        The observable certainty level
        of a reported indicator type. Confidence scores range from 0-100 in increasing order of confidence, and are assigned by ThreatStream based on several factors.
      name: confidence
    - description: The country associated with the indicator.
      name: country
    - description: |-
        When the indicator was first seen on
        the ThreatStream cloud platform. The date must be specified in this format:
        YYYYMMDDThhmmss, where "T" denotes the start of the value for time, in UTC time.
        For example, 2014-10-02T20:44:35.
      name: created_ts
    - description: The unique ID for the indicator.
      name: id
    - auto: PREDEFINED
      description: Whether the classification of the indicator is public. Default
        is "false".
      name: is_public
      predefined:
      - "false"
      - "true"
    - description: The severity assigned to the indicator by ThreatStream.
      name: indicator_severity
    - description: The registered owner (organization) of the IP address associated
        with the indicator.
      name: org
    - auto: PREDEFINED
      description: The status assigned to the indicator. Can be "active", "inactive",
        or "falsepos".
      name: status
      predefined:
      - active
      - inactive
      - falsepos
    - description: The tag assigned to the indicator.
      name: tags_name
    - auto: PREDEFINED
      description: The type of indicator. Can be "domain", "email", "ip", "MD5", "string",
        or "url".
      name: type
      predefined:
      - domain
      - email
      - ip
      - md5
      - string
      - url
    - description: 'The value of the indicator. '
      name: indicator_value
    - defaultValue: "20"
      description: The maximum number of results to return from ThreatStream. Default
        is 20.
      name: limit
    description: Return filtered indicators from ThreatStream. If a query is defined,
      it overrides all other arguments that were passed to the command.
    name: threatstream-get-indicators
    outputs:
    - contextPath: ThreatStream.Indicators.IType
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.Indicators.Modified
      description: |-
        The date and time the indicator was last updated in ThreatStream. The date format is: YYYYMMDDThhmmss, where T denotes the start of the value
        for time in UTC time.
      type: String
    - contextPath: ThreatStream.Indicators.Confidence
      description: The observable certainty level of a reported indicator type.
      type: String
    - contextPath: ThreatStream.Indicators.Value
      description: The indicator value.
      type: String
    - contextPath: ThreatStream.Indicators.Status
      description: The indicator status.
      type: String
    - contextPath: ThreatStream.Indicators.Organization
      description: The registered owner (organization) of the IP address associated
        with the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Country
      description: The country associated with the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Tags
      description: The tag assigned to the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.Indicators.ID
      description: The indicator ID.
      type: String
    - contextPath: ThreatStream.Indicators.ASN
      description: The Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Severity
      description: The severity assigned to the indicator.
      type: String
  - arguments:
    - auto: PREDEFINED
      defaultValue: intelligence
      description: The type of threat model entity to which to add the tag. Can be
        "actor", "campaign", "incident", "intelligence", "signature", "tipreport",
        "ttp", or "vulnerability".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
    - description: 'A comma separated list of tags applied to the specified threat
        model entities or observable. '
      isArray: true
      name: tags
      required: true
    - description: The ID of the model to which to add the tag.
      name: model_id
      required: true
    - auto: PREDEFINED
      defaultValue: red
      name: tag_type
      predefined:
      - red
      - white
    description: Adds tags to intelligence to filter for related entities.
    name: threatstream-add-tag-to-model
  - arguments:
    - auto: PREDEFINED
      description: The type of threat model to create. Can be "actor", "campaign",
        "incident", "ttp", "vulnerability", or "tipreport".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - ttp
      - vulnerability
      - tipreport
      - malware
      - attackpattern
      - identity
      - courseofaction
      - infrastructure
      - intrusionset
      - signature
      - tool
      required: true
    - description: The name of the threat model to create.
      name: name
      required: true
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether the scope of threat model is visible.
      name: is_public
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      defaultValue: red
      description: The Traffic Light Protocol designation for the threat model. Can
        be "red", "amber", "green", or "white".
      name: tlp
      predefined:
      - red
      - amber
      - green
      - white
    - description: A comma separated list of tags.
      name: tags
    - description: A comma separated list of indicators IDs associated with the threat
        model on the ThreatStream platform.
      name: intelligence
    - description: The description of the threat model.
      name: description
    - auto: PREDEFINED
      name: malware_types
      predefined:
      - unknown
      - malware
    - description: Reporting Source
      name: source
    - description: Import Session IDs to associate with threat bulletin
      name: import_session
    - description: Trusted Circle ID
      name: circles
    - auto: PREDEFINED
      description: signature type
      name: s_type
      predefined:
      - Snort
      - YARA
      - CybOX
      - OpenIOC
      - ClamAV
      - Suricata
      - Bro
      - CarbonBlackQuery
      - Custom
    - description: War Room Entry ID of File
      name: file_id
    - description: Time stamp of when created
      name: source_created
    - description: Time stamp of when modified
      name: source_modified
    - description: Association IDs, Comma separated for multiple IDs
      name: associations
    - description: 'ThreatModel type to associate. Only one type allowed at a time,
        use update-model to add more. '
      name: association_type
    description: Creates a threat model with the specified parameters.
    name: threatstream-create-model
    outputs:
    - contextPath: ThreatStream.Model.ModelType
      description: The threat model type.
      type: String
    - contextPath: ThreatStream.Model.ModelID
      description: The threat model ID.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Value
      description: The value of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ID
      description: The ID of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.IType
      description: The iType of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Severity
      description: The severity of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Confidence
      description: The confidence of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Country
      description: The country of the indicator associated with the specified model
      type: String
    - contextPath: ThreatStream.Model.Indicators.Organization
      description: The organization of the indicator associated with the specified
        model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ASN
      description: The ASN of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Status
      description: The status of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Tags
      description: The tags of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Modified
      description: The date and time the indicator was last modified.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Type
      description: The indicator type.
      type: String
  - arguments:
    - auto: PREDEFINED
      description: The type of threat model to update. Can be "actor", "campaign",
        "incident", "ttp", "vulnerability", or "tipreport".
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - ttp
      - vulnerability
      - tipreport
      required: true
    - description: The ID of the threat model to update.
      name: model_id
      required: true
    - description: The name of the threat model to update.
      name: name
    - auto: PREDEFINED
      defaultValue: "false"
      description: Whether the scope of threat model is visible.
      name: is_public
      predefined:
      - "true"
      - "false"
    - auto: PREDEFINED
      defaultValue: red
      description: The Traffic Light Protocol designation for the threat model. Can
        be "red", "amber", "green", or "white".
      name: tlp
      predefined:
      - red
      - amber
      - green
      - white
    - description: A comma separated list of tags.
      name: tags
    - description: A comma separated list of indicator IDs associated with the threat
        model on the ThreatStream platform.
      name: intelligence
    - description: The description of the threat model.
      name: description
    description: Updates a threat model with specific parameters. If one or more optional
      parameters are defined, the command overrides previous data stored in ThreatStream.
    name: threatstream-update-model
    outputs:
    - contextPath: ThreatStream.Model.ModelType
      description: The threat model type.
      type: String
    - contextPath: ThreatStream.Model.ModelID
      description: The threat model ID.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Value
      description: The value of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ID
      description: The ID of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.IType
      description: The iType of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Severity
      description: The severity of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Confidence
      description: The confidence of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Country
      description: The country of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Organization
      description: The organization of the indicator associated with the specified
        model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ASN
      description: The ASN of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Status
      description: The status of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Tags
      description: The tags of the indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Modified
      description: The date and time the indicator was last modified.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Type
      description: The indicator type.
      type: String
  - arguments:
    - auto: PREDEFINED
      defaultValue: default
      description: The type of sandbox ("default" or "premium").
      name: sandbox_type
      predefined:
      - default
      - premium
    description: Returns a list of supported platforms for default or premium sandbox.
    name: threatstream-supported-platforms
    outputs:
    - contextPath: ThreatStream.PremiumPlatforms.Name
      description: The name of the supported platform for premium sandbox.
      type: String
    - contextPath: ThreatStream.PremiumPlatforms.Types
      description: The type of supported submissions for premium sandbox.
      type: String
    - contextPath: ThreatStream.PremiumPlatforms.Label
      description: The display name of the supported platform of premium sandbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Name
      description: The name of the supported platform for standard sandbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Types
      description: The type of the supported submissions for standard sandbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Label
      description: The display name of the supported platform of standard sandbox.
      type: String
  - arguments:
    - default: true
      description: The URL to check.
      isArray: true
      name: url
      required: true
    - description: If confidence is greater than the threshold the URL is considered
        malicious, otherwise it is considered good. This argument overrides the default
        URL threshold defined as a parameter.
      name: threshold
    - auto: PREDEFINED
      description: Whether to include results with an inactive status.
      name: include_inactive
      predefined:
      - "True"
      - "False"
    description: Checks the reputation of the given URL.
    name: url
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: URL.Data
      description: The URL of the indicator.
      type: String
    - contextPath: URL.Malicious.Vendor
      description: The vendor that reported the indicator as malicious.
      type: String
    - contextPath: ThreatStream.URL.Modified
      description: |-
        The date and time the indicator was last updated. The date format is: YYYYMMDDThhmmss, where "T" denotes the start of the value
        for time in UTC time.
      type: String
    - contextPath: ThreatStream.URL.Confidence
      description: The observable certainty level of a reported indicator type. Confidence
        score ranges from 0-100, in increasing order of confidence.
      type: String
    - contextPath: ThreatStream.URL.Status
      description: The indicator status.
      type: String
    - contextPath: ThreatStream.URL.Organization
      description: The name of the business that owns the IP address associated with
        the indicator.
      type: String
    - contextPath: ThreatStream.URL.Address
      description: The indicator URL.
      type: String
    - contextPath: ThreatStream.URL.Country
      description: The country associated with the indicator.
      type: String
    - contextPath: ThreatStream.URL.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.URL.Source
      description: The indicator source.
      type: String
    - contextPath: ThreatStream.URL.Severity
      description: The indicator severity ("very-high", "high", "medium", or "low").
      type: String
    - contextPath: ThreatStream.URL.Tags
      description: Tags assigned to the URL.
      type: Unknown
    - contextPath: URL.Tags
      description: List of URL tags.
      type: Unknown
    - contextPath: URL.ThreatTypes
      description: Threat types associated with the url.
      type: Unknown
  - arguments:
    - description: Anomali Observable Search Filter Language query to filter indicatorts
        results. If a query is passed as an argument, it overides all other arguments.
      name: query
      required: true
    description: Gets Count of Indicators based on query.
    name: threatstream-get-indicators-count
    outputs:
    - contextPath: Count
      description: Count of IOCs
      type: string
  - arguments:
    - description: Import Session ID
      name: import_id
      required: true
    description: Approves an import job that is in Ready to Review status
    name: threatstream-approve-import
  - arguments:
    - description: Import Session ID
      name: import_id
      required: true
    description: Checks if an import job is in Ready to Review status
    name: threatstream-get-import-status
  - arguments:
    - description: Threat Model ID
      name: bulletin_id
      required: true
    - description: Trusted Circle ids, comma separated for multiple values
      name: trustedcircles
    - auto: PREDEFINED
      description: Threat Model Type
      name: modeltype
      predefined:
      - tipreport
      - ttp
      - actor
      - campaign
      - incident
      - signature
      - malware
      - vulnerability
      - attackpattern
      - infrastructure
      - intrusionset
      - identity
      - tool
      required: true
    description: Sets a threat model bulletin to the Published state with private
      visibility
    name: threatstream-publish-bulletin
  - arguments:
    - description: ID of  threat model/bulletin
      name: bulletin_id
      required: true
    - description: ID of file uploaded to war room
      name: file_id
      required: true
    - auto: PREDEFINED
      defaultValue: tipreport
      name: model_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    description: Attaches a file to a Threat Model/Bulletin
    name: threatstream-attach-file-to-bulletin
  - arguments:
    - description: ID of the indicator/observable
      name: indicator_id
      required: true
    - auto: PREDEFINED
      description: New status for indicator/observable
      name: status
      predefined:
      - inactive
      - active
      - falsepos
      required: true
    description: Modifies the indicator/observable status
    name: threatstream-change-indicator-status
  - arguments:
    - description: ID of indicator/observable
      name: indicator_id
      required: true
    - description: Type of indicator/observable
      name: itype
    - description: Traffic Light Protocol
      name: tlp
    - description: 'Valid Range: 0-100'
      name: confidence
    - auto: PREDEFINED
      description: New severity for indicator/observable
      name: severity
      predefined:
      - low
      - medium
      - high
      - very-high
    - auto: PREDEFINED
      description: New status for indicator/observable
      name: status
      predefined:
      - inactive
      - active
      - falsepos
    - description: Numerical value for number of days - i.e 30 , 60, 90
      name: expiration_date
    description: Edit attributes of indicator/observable
    name: threatstream-edit-indicator
  - arguments: []
    description: Returns a list of the 10 most recently added whitelist entries
    name: threatstream-whitelist-get-recent-entries
  - arguments:
    - auto: PREDEFINED
      description: 'The type: CIDR, IP address, Domain, URL, Email Address, User Agent,
        or Hash'
      name: value_type
      predefined:
      - cidr
      - ip
      - domain
      - url
      - email
      - user-agent
      - md5
      required: true
    - description: value of the entry you want to add
      name: value
      required: true
    - description: contextual note associated with the entry
      name: notes
    description: Adds an entry to the whitelist
    name: threatstream-whitelist-add-entry
  - arguments:
    - description: ID of file uploaded to the war room
      name: file_id
      required: true
    description: Adds entries to whitelist given a csv file
    name: threatstream-whitelist-add-entries-from-csv
  - arguments:
    - auto: PREDEFINED
      defaultValue: json
      description: json or csv
      name: file_format
      predefined:
      - json
      - csv
    description: Export the whitelist in json or csv format
    name: threatstream-whitelist-export
  - arguments:
    - description: ID of the whitelist entry to delete
      name: entry_id
      required: true
    description: Remove an entry from the whitelist
    name: threatstream-whitelist-remove-entry
  - arguments:
    - description: ID associated with the whitelist entry
      name: entry_id
      required: true
    - description: comment entry around whitelist indicator
      name: note
      required: true
    description: Edit the note associated with a whitelist entry
    name: threatstream-whitelist-edit-entry-note
  - arguments:
    - name: bulletin_id
      required: true
    - description: Title of the comment
      name: title
      required: true
    - description: comment associated with the threat model/bulletin
      name: comment
      required: true
    - description: Traffic Light Protocol
      name: tlp
    - auto: PREDEFINED
      defaultValue: tipreport
      description: Threat Model Type
      name: model_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    description: Add a comment to a threat model/bulletin
    name: threatstream-comment-bulletin
  - arguments:
    - description: 'The value associated with the indicator/observable. Example: 192.168.1.1'
      name: indicator_value
      required: true
    - description: Comment to add
      name: comment
      required: true
    - auto: PREDEFINED
      defaultValue: red
      description: Traffic Light Protocol
      name: tlp
      predefined:
      - white
      - green
      - amber
      - red
    description: Add a comment to an indicator/observable
    name: threatstream-comment-indicator
  - arguments:
    - description: ID associated with the Import Session
      name: import_id
      required: true
    - description: Enter the IDs as comma separated values
      name: ioc_ids
    description: To use this command, use the command with the Import Session ID,
      import_id, and no ioc_ids argument first. This will display the excluded indicators
      from the import session. Then use the command again, but with import_id and
      the ioc_ids that you want included.
    name: threatstream-include-indicator
  - arguments:
    - description: ID associated with the Import Session
      name: import_id
      required: true
    - description: ID associated with the indicator/observable, can be found from
        using this command with only the import_id argument
      name: ioc_ids
    description: Excludes the indicator/observable from an Import Session. To use
      this command, use the command with the Import Session ID(import_id) and no ioc_ids
      argument first. This will display the included indicators from the import session.
      Then use the command again, but with import_id and the ioc_ids that you want
      excluded.
    name: threatstream-exclude-indicator
  - arguments:
    - description: ID associated with an import session
      name: import_id
      required: true
    - description: comma separated names
      name: tag_names
      required: true
    - description: corresponding comma separated tlps
      name: tlps
    description: Applies tags to an Import Session
    name: threatstream-add-tags-to-import
  - arguments: []
    description: Retrieves the 20 most recent investigations
    name: threatstream-recent-investigations
  - arguments:
    - description: ID associated with the investigation
      name: investigation_id
      required: true
    description: Retrieve a specific investigation and its attributes
    name: threatstream-get-investigation
  - arguments:
    - description: ID associated with the Import Session
      name: import_id
      required: true
    - description: Enter the IDs as comma separated values
      name: ioc_ids
    name: threatstream-force-apply-tags
  - arguments:
    - description: ID of assignee, can be user, workgroup, or unassigned
      name: assignee_id
    - auto: PREDEFINED
      description: Type of assignee, select from list
      name: assignee_type
      predefined:
      - user
      - workgroup
      - unassigned
    - description: Description of investigation
      name: description
    - description: Investigation name
      name: name
    - auto: PREDEFINED
      defaultValue: verylow
      description: Investigation priority
      name: priority
      predefined:
      - verylow
      - low
      - medium
      - high
      - veryhigh
    - auto: PREDEFINED
      description: traffic light protocol
      name: tlp
      predefined:
      - red
      - white
      - green
      - amber
    - description: 'comma separated entities. Example: <r_type>,<r_id>,<add_related_indicators>,<r_type>,<r_id>,<add_related_indicators>,etc.
        <r_type> options: actor,campaign,incident,intelligence2(observable),signature,tip_report,ttp,vulnerability.
        <r_id>: the id associated with the <r_type>. <add_related_indicators>: When
        enabled,observables related to the entity you are associating with the investigation
        are also added, <add_related_indicators> = 1 (enabled), <add_related_indicators>
        = 0 (disabled).'
      name: associations
    - auto: PREDEFINED
      description: status of investigation
      name: status
      predefined:
      - in-progress
      - unassigned
      - pending
      - completed
    - description: trusted circle ids
      name: circles
    - description: Tags for investigation
      name: tags
    description: Creates an investigation with given entities associated with the
      investigation
    name: threatstream-create-investigation
  - arguments:
    - description: ID associated with the investigation
      name: investigation_id
      required: true
    - description: New description associated with the investigation
      name: description
    - description: ID associated with the user
      name: assignee_id
    - auto: PREDEFINED
      description: Type of Assignee
      name: assignee_type
      predefined:
      - user
      - workgroup
      - unassigned
    - description: Name of the Investigation
      name: name
    - auto: PREDEFINED
      description: Investigation priority
      name: priority
      predefined:
      - verylow
      - low
      - medium
      - high
      - veryhigh
    - auto: PREDEFINED
      description: Traffic Light Protocol
      name: tlp
      predefined:
      - red
      - white
      - amber
      - green
    - name: circles
    - auto: PREDEFINED
      description: Status of the Investigation
      name: status
      predefined:
      - in-progress
      - unassigned
      - pending
      - completed
    - description: Investigation tags
      name: tags
    - description: 'comma separated entities. Example: <r_type>,<r_id>,<add_related_indicators>,<r_type>,<r_id>,<add_related_indicators>,etc.
        <r_type> options: actor,campaign,incident,intelligence2(observable),signature,tip_report,ttp,vulnerability.
        <r_id>: the id associated with the <r_type>. <add_related_indicators>: When
        enabled,observables related to the entity you are associating with the investigation
        are also added, <add_related_indicators> = 1 (enabled), <add_related_indicators>
        = 0 (disabled).'
      name: associations
    description: Updates the description of the investigation
    name: threatstream-update-investigation
  - arguments:
    - description: ID associated with the investigation
      name: investigation_id
      required: true
    description: Deletes an investigation
    name: threatstream-delete-investigation
  - arguments:
    - description: 'The value of the indicator. For example: ip, url'
      name: ioc_value
      required: true
    - description: The max number of sightings to get and output.
      name: limit
    - description: The position in the dataset, will retrieve sightings starting at
        offset.
      name: offset
    - auto: PREDEFINED
      defaultValue: domain
      description: Indicator type
      name: ioc_type
      predefined:
      - ip
      - domain
      - email
    description: Get myAttacks sightings data for a given indicator of compromise
    name: threatstream-get-ioc-sightings
  - arguments:
    - description: 'ISO-8061 format, example: 2020-06-01T12:00:00-04:00'
      name: reported_ts
      required: true
    - description: The number of instances seen
      name: count
      required: true
    - name: attack_type
    - name: attacker_address
    - name: attacker_countrycode
    - name: attacker_hostname
    - name: device_source
    - name: outcome
    - name: request_url
    - name: source_email
    - name: tags
    - name: target_address
    - name: target_hostname
    - name: target_port
    - name: transport_protocol
    description: 'Add a sighting instance to an indicator of compromise '
    name: threatstream-add-myattacks-sighting
  - arguments:
    - description: The id associated with the observable/indicator
      name: ioc_id
      required: true
    - auto: PREDEFINED
      name: reason
      predefined:
      - This indicator used to be malicious but is no longer
      - This indicator may be malicious but it is serving content I care about
      - The indicator is mislabeled (Use the text area below to indicate a new label
      - I do not care about this kind of indicator within my environment
      - The indicator is not malicious and it probably never was
      required: true
    - name: comment
    description: Reports the observable/indicator as false positive to Anomali
    name: threatstream-report-false-positive
  - arguments:
    - description: The name of the rule
      name: name
      required: true
    - description: comma separated values
      name: keywords
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether the rule should match keywords in newly created Observables.
      name: match_observables
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether the rule should match keywords in newly created Sandbox
        Reports.
      name: match_reportedfiles
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether the rule should match keywords in newly created Signatures.
      name: match_signatures
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether the rule should match keywords in newly created Threat
        Bulletins.
      name: match_tips
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether the rule should match keywords in newly created Vulnerabilities.
      name: match_vulnerabilities
      predefined:
      - "True"
      - "False"
    - description: IDs of the Actors with which you want to associate matched entities.
        comma separated IDs.
      name: actors
    - description: IDs of the Campaigns with which you want to associate matched entities.
        comma separated IDs.
      name: campaigns
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether you want to create a dedicated investigation the first
        time the rule is triggered. All intelligence in which keywords appear are
        added to the investigation.
      name: create_investigation
      predefined:
      - "True"
      - "False"
    - description: 'Indicator types you want to exclude from rule matches. Example:
        actor_ipv6'
      name: exclude_impacts
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether you want to exclude the rule from matching Observables
        that are included in your organization whitelist.
      name: exclude_notify_org_whitelisted
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      defaultValue: "False"
      description: Whether you want to exclude the rule from matching Observables
        imported by your organization from keyword match or hourly digest email notifications.
      name: exclude_notify_owner_org
      predefined:
      - "True"
      - "False"
    - description: IDs of the incidents with which you want to associate matched entities.
      name: incidents
    - description: IDs of the malware with which you want to associate matched entities.
      name: malware
    - auto: PREDEFINED
      defaultValue: "False"
      description: 'Indicators types in which you want to look for rule matches at
        the exclusion of all others. Example: actor_ipv6'
      name: match_impacts
      predefined:
      - "True"
      - "False"
    - description: IDs of the Signatures with which you want to associate matched
        entities.
      name: signatures
    - description: 'Tags applied to matched entities. Tags must be specified as in
        the following example: tags=["tag1", "tag2"] Tag Visibility Settings: You
        can add tags that are private to your organization by setting the tlp attribute
        for the tag to red. In these cases, tags must been closed in brackets along
        with the tag name and tlp setting. For example, tags=[{“name”:"my_private_
        tag",“tlp”:"red"}, {"name":"malware","tlp":"white"}]'
      name: tags
    - description: IDs of the Threat Bulletins with which you want to associate matched
        entities.
      name: tips
    - description: IDs of the TTPs with which you want to associate matched entities.
      name: ttps
    - description: IDs of the Vulnerabilities with which you want to associate matched
        entities.
      name: vulnerabilities
    - auto: PREDEFINED
      defaultValue: red
      description: Traffic Light Protocol for Tags
      name: tlp
      predefined:
      - red
      - white
    - name: org_id
    - auto: PREDEFINED
      defaultValue: "False"
      name: notify_me
      predefined:
      - "True"
      - "False"
    description: To create a rule in Anomali ThreatStream
    name: threatstream-create-rule
  - arguments: []
    description: To retrieve a list of the 20 most recently configured rules
    name: threatstream-get-rules
  - arguments:
    - description: ID of the rule that you want to modify
      name: rule_id
      required: true
    - description: Name of the rule
      name: name
    - description: Keywords for which you want the rule to match
      name: keywords
    - auto: PREDEFINED
      description: Whether the rule should match keywords in newly created Observables.
      name: match_observables
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether the rule should match keywords in newly created Sandbox
        Reports.
      name: match_reportedfiles
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether the rule should match keywords in newly created Signatures.
      name: match_signatures
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether the rule should match keywords in newly created Threat
        Bulletins.
      name: match_tips
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether the rule should match keywords in newly created Vulnerabilities.
      name: match_vulnerabilities
      predefined:
      - "True"
      - "False"
    - description: IDs of the Actors with which you want to associate matched entities.
      name: actors
    - description: IDs of the Campaigns with which you want to associate matched entities.
      name: campaigns
    - auto: PREDEFINED
      description: Whether you want to create a dedicated investigation the first
        time the rule is triggered. All intelligence in which keywords appear are
        added to the investigation.
      name: create_investigation
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: 'Indicator types you want to exclude from rule matches. Example:
        actor_ipv6'
      name: exclude_impacts
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether you want to exclude the rule from matching Observables
        that are included in your organization whitelist.
      name: exclude_notify_org_whitelisted
      predefined:
      - "True"
      - "False"
    - auto: PREDEFINED
      description: Whether you want to exclude keyword matches on Observables imported
        by your organization from Keyword Match or Hourly Digest email notifications.
      name: exclude_notify_owner_org
      predefined:
      - "True"
      - "False"
    - description: IDs of the Incidents with which you want to associate matched entities.
      name: incidents
    - description: IDs of the Malware with which you want to associate matched entities.
      name: malware
    - description: 'Indicators types in which you want to look for rule matches at
        the exclusion of all others. Example: actor_ipv6'
      name: match_impacts
    - description: IDs of the Signatures with which you want to associate matched
        entities.
      name: signatures
    - description: 'Tags applied to matched entities. Tags must be specified as in
        the following example: tags=["tag1", "tag2"] Tag Visibility Settings: You
        can add tags that are private to your organization by setting the tlp attribute
        for the tag to red.In these cases, tags must be enclosed in brackets along
        with the tag name and tlp setting. For example, tags=[{“name”:"my_private_
        tag",“tlp”:"red"}, {"name":"malware","tlp":"white"}]'
      name: tags
    - description: IDs of the Threat Bulletins with which you want to associate matched
        entities.
      name: tips
    - description: IDs of the TTPs with which you want to associate matched entities.
      name: ttps
    - description: IDs of the Vulnerabilities with which you want to associate matched
        entities.
      name: vulnerabilities
    - auto: PREDEFINED
      description: Traffic Light Protocol for Tags
      name: tlp
      predefined:
      - red
      - white
    - description: Organization ID (required for tags)
      name: org_id
    - auto: PREDEFINED
      description: Indicate whether the rule should notify the creator
      name: notify_me
      predefined:
      - "True"
      - "False"
    description: Update a rule in Anomali ThreatStream
    name: threatstream-update-rule
  - arguments:
    - description: ID associated with the rule
      name: rule_id
      required: true
    description: Delete a rule in Anomali ThreatStream
    name: threatstream-delete-rule
  - arguments:
    - auto: PREDEFINED
      name: model_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
    - auto: PREDEFINED
      name: general_options
      predefined:
      - Show Only My Organization
      - Show Only Open Source Threat Models
    - auto: PREDEFINED
      description: Traffic Light Protocol. comma separated for multiple values
      name: tlp
      predefined:
      - red
      - amber
      - green
      - white
    - auto: PREDEFINED
      description: custom date input available
      name: date_last_updated
      predefined:
      - Last 30 Days
      - Last 90 Days
      - This year
    - description: comma separated.
      name: tags
    - auto: PREDEFINED
      description: comma separated
      name: publication_status
      predefined:
      - new
      - review_requested
      - reviewed
      - published
    - auto: PREDEFINED
      description: comma separated
      name: visibility
      predefined:
      - Anomali Community
      - My Organization
    - description: comma separated stream source IDs (feed_id)
      name: streams
    - description: comma separated source IDs (trusted_circle_ids)
      name: source_id
    - description: comma separated
      name: assignee_id
    - description: comma separated
      name: owner_id
    - description: keyword search
      name: value
    - description: Organization ID -- required value if using general_options == "Show
        Only My Organization"
      name: org_id
    description: To retrieve threat model entities from ThreatStream.
    name: threatstream-threat-model-search
  - arguments:
    - defaultValue: "1000"
      description: Max number of sessions to retrieve, optional
      name: limit
      required: true
    - auto: PREDEFINED
      defaultValue: done
      name: status
      predefined:
      - done
      - processing
      - approving
      - rejecting
      - deleting
      - errors
      - approved
      - deleted
      required: true
    description: To retrieve import sessions in the selected status
    name: threatstream-get-import-sessions
  - arguments:
    - name: rule_id
      required: true
    name: threatstream-get-rule-by-id
  - arguments:
    - name: rule_id
      required: true
    - defaultValue: "50"
      name: limit
    name: threatstream-get-rule-matches
  - arguments: []
    name: threatstream-get-trusted-circle-requests
  - arguments:
    - name: invite_id
      required: true
    name: threatstream-accept-trusted-circle-requests
  - arguments:
    - auto: PREDEFINED
      description: Threat Model Type
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    - description: The threat model id
      name: id
      required: true
    description: Get threat model information
    name: threatstream-get-model
  - arguments:
    - description: ID of the threat model to add the reference to
      name: bulletin_id
      required: true
    - description: Reference URL to add
      name: url
      required: true
    - description: Title of reference
      name: reference_name
      required: true
    - auto: PREDEFINED
      description: Type of threat model
      name: model_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      required: true
    description: Attach URL reference to a threat model (tipreport not supported)
    name: threatstream-attach-reference-to-bulletin
  - arguments:
    - description: ID of Threat Model
      name: model_id
    - auto: PREDEFINED
      description: Threat Model type
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      - intelligence
    - auto: PREDEFINED
      description: Threat Model Type to associate
      name: association_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      - intelligence
    - description: Threat Model ID to associate
      name: association_ids
    description: Add associations to models
    name: threatstream-add-associations
  - arguments:
    - description: Trusted Circle ID
      name: trusted_circle_id
    description: Get a list of Organization Members to a trusted circle
    name: threatstream-get-trusted-circle-members
  - arguments:
    - description: Threat Model ID
      name: model_id
      required: true
    - auto: PREDEFINED
      description: Threat Model type
      name: model_type
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - tipreport
      - ttp
      - malware
      - attackpattern
      - courseofaction
      - identity
      - infrastructure
      - intrusionset
      - tool
      - vulnerability
      - intelligence
      required: true
    name: threatstream-delete-threat-model
  dockerimage: demisto/py3-tools:0.0.1.26536
  isFetchSamples: true
  isfetch: true
  runonce: false
  script: ''
  subtype: python3
  type: python
sourcemoduleid: Anomali ThreatStream v3
